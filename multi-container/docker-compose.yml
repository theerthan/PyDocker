version: '2'
services:

  web:
    image: gcr.io/anand-bindumadhavan/multi-compose
    build: .
    command: python -u app.py
    ports:
      - 5000:5000
    volumes:
      - .:/todo
    links:
      - db
    depends_on:
      - db
    environment:
      MONGODB_HOST: 172.16.1.3
    networks:
      db_net:
        ipv4_address: 172.16.1.2


  db:
    image: mongo:3.4.0
    ports:
      - 27017:27017
    networks:
      db_net:
        ipv4_address: 172.16.1.3

networks:
  db_net:
    ipam:
        driver: default
        config:
            - subnet: 172.16.1.0/24
              gateway: 172.16.1.1
